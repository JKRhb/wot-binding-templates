<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c' class='remove'></script>
    <script class='remove'>
        var respecConfig = {
            specStatus: "ED",
            editors: [{
                name: "Michael Koster",
                w3cid: "110658",
                company: "SmartThings",
                companyURL: "https://www.smartthings.com/"
                },
                {
                name: "Ege Korkan",
                w3cid: "110131",
                company: "Siemens AG",
                companyURL: "https://www.siemens.com/"
                }
            ],
            edDraftURI: "https://w3c.github.io/wot-binding-templates/bindings/protocols/mqtt/",
            shortName: "wot-mqtt-binding",
            github: "https://github.com/w3c/wot-binding-templates/tree/main/bindings/protocols/mqtt",
        };
    </script>
    <title>MQTT Binding Template</title>
</head>

<body>
    <section id="abstract">
      <p class="ednote">To be defined</p>
    </section>
    <section id='introduction'>
        <h2>Introduction</h2>
        <p class="ednote">the following is a draft introduction</p>
        <p>
            This document describes how to map the MQTT protocol to the W3C Web of Things.
        </p>
    </section>
    <section id='sotd'>
        <p>
            <em>This document is a work in progress</em>
        </p>
    </section>
    <section id="url">
      <h2>URL format</h2>
      <p class="ednote">There is no clear consensus on the correct URL format for MQTT protocol binding</p>
       <pre>
            {scheme}://{address}:{port}
        </pre>

        <p>
            Where:
            <ul>
                <li><code>{scheme}</code> is the protocol scheme, either <code>mqtt</code> or <code>mqtts</code></li>
                <li><code>{address}</code> is the IP address of the MQTT broker</li>
                <li><code>{port}</code> is the port of the MQTT broker</li>
            </ul>
        </p>
    </section>
    <section>
      <h3>MQTT Vocabulary</h3>
    <section>
      <h4>Form terms</h4>
      <table class="def">
        <thead>
          <tr>
            <th>Vocabulary term</th>
            <th>Description</th>
            <th>Assignment</th>
            <th>Type</th>
          </tr>
        </thead>
        <tbody>
          <!-- Generate forms terms from the ontology-->
          %s
        </tbody>
      </table>
    </section>
    <section id="controlpacket">
      <h4>Control Packet</h4>
      <p>
        In MQTT protocol messages are called Control Packets. An MQTT Control Packet consists of up to three parts: fixed header (prsesent in all Control Packets), variable header,
        payload. The fixed header consists of a packet type and flags. The main packet types that can be uses in a Form are listed below. 
      </p>
      <table class="def">
        <thead>
          <tr>
            <th>Value</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <!-- Generate packet values from the ontology-->
          %s
        </tbody>
      </table>
    </section>
    <section id="qualityofservice">
      <h4>QualityOfService</h4>
      <p>
        <!-- Generate qos description from the ontology-->
        %s
      </p>
      <table class="def">
        <thead>
          <tr>
            <th>Value</th>
            <th>Name</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <!-- Generate qos values from the ontology-->
          %s
        </tbody>
      </table>
    </section>
    <section id="topicname">
      <h4>TopicName</h4>
      <p>
        <!-- Generate description form the ontology-->
        %s
      </p>
    
    </section>
    <section id="topicfilter">
      <h4>TopicFilter</h4>
      <p>
        <!-- Generate description form the ontology-->
        %s
      </p>
    
    </section>
    </section>
    <section>
      <h3>Mappings</h3>
      <p>This section describes strategies and default values to employ protocol specific concepts within the <a
          href="https://w3c.github.io/wot-architecture/#dfn-interaction-model">WoT Interaction
          model</a>. </p>
      <section id="default-mappings">
        <h3>Default mappings</h3>
      <table class="def">
        <thead>
          <tr>
            <th><code>op</code> value</th>
            <th>Default Binding</th>
          </tr>
        </thead>
        <tbody>
          <!-- Generate forms terms from the ontology-->
          %s
        </tbody>
      </table>
      </section>
      <section id="possible-mappings">
        <h3>Possible mappings</h3>
      For the MQTT protocol, if an MQTT client publishes a message to a topic with the retain flag set to true, the future subscribers of the topic will also get this message.
      Outside of this case, it is not possible to read a property but only possible to observe it. 
      <span class="rfc2119-assertion" id="iana-security-alter">Additionally, in a Form element with MQTT protocol, if the <code>op</code> contains <code>readproperty</code> (meaning that retain flag is set to true), it <em class="rfc2119" title="SHOULD">SHOULD</em> also contain <code>observeproperty</code>.</span>
      <span class="rfc2119-assertion" id="iana-security-alter">On the other hand, if the MQTT publisher does not set
        the retain flag to true, the property will be only observable. In this case, the property in the exposed Thing
        Description <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> have Form elements with MQTT protocol containing <code>readproperty</code> operation.</span>
      </section>
  </section>
    <section>
      <h2>Examples</h2>
      <p>The following examples show how to use the MQTT protocol in a Thing Description.</p>
      <p class="ednote">TODO:</p>
    </section>
</body>

</html>